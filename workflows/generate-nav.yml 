name: Auto Generate Folder Navigation
on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  generate:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    
    - name: Generate folder index
      run: |
        cat > index.md << EOF
---
layout: default
title: Auto Folder Navigation
---

# ğŸ“ Auto-Generated Folder Structure

## Folders
\`\`\`
$(find . -type d -not -path "./.git*" -not -path "./*" | sed 's|^\./||' | sort)
\`\`\`

## Direct Links
$(find . -maxdepth 2 -name "index.md" -o -name "*.md" -o -name "*.html" | sed 's|^\./||' | sed 's|\.md$||' | sed 's|\.html$||' | sort | awk '{printf "| [%s](%s/) |\n", $1, $1}')
        
---
        EOF
        
    - uses: actions/upload-pages-artifact@v3
      with:
        path: .
        
    - name: Commit changes
      run: |
        git config user.name "GitHub Action"
        git config user.email "action@github.com"
        git add index.md
        git commit -m "Auto-update folder navigation" || echo "No changes"
        git push
